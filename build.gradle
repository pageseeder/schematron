plugins {
  id 'application'
  id 'maven-publish'
  id 'io.codearte.nexus-staging' version '0.30.0'
}

group       = 'org.pageseeder.schematron'
version     = file('version.txt').text
description = "$title"

apply from: 'gradle/publish-mavencentral.gradle'

tasks.withType(JavaCompile) {
  options.encoding = 'UTF-8'
}

repositories {
  mavenCentral {
    url = uri("https://maven-central.storage.googleapis.com/maven2")
  }
}

configurations {
  include
}

dependencies {

  include('name.dmaus.schxslt:schxslt:1.9.4')

  testImplementation('junit:junit:4.13.2')

  testRuntimeOnly('net.sf.saxon:Saxon-HE:11.3')

}

task includeTemplates(type: Copy) {
  from { configurations.include.collect { zipTree(it) } }
  exclude '/xproc/**'
  exclude '/META-INF/**'
  into 'src/main/resources/org/pageseeder/schematron/'
}

jar {
  manifest {
    attributes(
        'Main-Class': 'org.pageseeder.schematron.Main'
    )
  }
}

java {
  toolchain {
    languageVersion.set(JavaLanguageVersion.of(8))
  }
}

application {
  mainClassName = 'org.pageseeder.schematron.Main'
}